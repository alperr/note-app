<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Note List</title>
    <link href="bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
    <button id="newNoteBtn" class="btn btn-primary mb-3">New Note</button>
    <div id="noteList"></div>

    <script>
        const API_BASE = 'http://localhost:3000';

        async function fetchNotes() {
            try {
                const response = await fetch(`${API_BASE}/notes`);
                const notes = await response.json();
                displayNotes(notes);
            } catch (error) {
                console.error('Error fetching notes:', error);
            }
        }

        function displayNotes(notes) {
            const noteList = document.getElementById('noteList');
            noteList.innerHTML = `
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Created At</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            `;
            const tbody = noteList.querySelector('tbody');
            notes.forEach(note => {
                const row = document.createElement('tr');
                row.style.cursor = 'pointer';

                const nameCell = document.createElement('td');
                nameCell.textContent = note.name;
                row.appendChild(nameCell);

                const createdCell = document.createElement('td');
                const date = note.created_at ? new Date(note.created_at) : null;
                createdCell.textContent = date && !isNaN(date) ? date.toLocaleString() : 'Unknown';
                row.appendChild(createdCell);

                row.onclick = () => window.location.href = `edit-note.html?id=${note.id}`;
                tbody.appendChild(row);
            });
        }

        document.getElementById('newNoteBtn').onclick = () => {
            window.open('edit-note.html', '_blank');
        };

        fetchNotes();
    </script>
<script src="bootstrap.bundle.min.js"></script>
</body>
</html>